<div class="container-fluid py-4" style="background-color: #F7F1E3; min-height: 100vh;">
    <div class="container bg-white p-4 rounded-4 shadow" style="background-color: #FAF9F6;">
  
      <!-- Header -->
      <div class="d-flex justify-content-between align-items-center flex-wrap mb-3">
        <h2 class="fw-bold text-uppercase" style="color: #5B3711;">{{ donation?.title }}</h2>
        <span class="badge rounded-pill px-3 py-2" [ngStyle]="{
          backgroundColor: donation?.food_category === 'VEG' ? '#5B8C5A' : '#F77F00',
          color: 'white'
        }">
          {{ donation?.food_category }}

        </span>
        <!-- *ngIf="donation?.donorEmail === currentUser.email" -->
        <div  class="d-flex align-items-center">
          <i class="bi bi-pencil-square text-primary me-3" role="button" (click)="openEditModal(donation)"></i>
          <i class="bi bi-trash text-danger" role="button" (click)="deleteDonation(donation.id)"></i>
        </div>
  
      <!-- Expiry Countdown -->
      <div *ngIf="timeRemaining" class="alert alert-warning py-2 px-3">
        ‚è≥ <strong>Expires in:</strong> {{ timeRemaining }}
      </div>
  
      <div class="row g-4 mt-3">
        <!-- Left Column -->
        <div class="col-lg-7">
          <!-- Description Block -->
          <div class="mb-3" style="color: #5B3711;">
            <strong class="text-muted">üìù Description:</strong>
            <div class="border rounded-4 p-3 bg-light shadow-sm mt-2" style="white-space: pre-line;">
              {{ donation?.description }}
            </div>
          </div>
  
          <div class="mb-2"><strong class="text-muted">üçΩ Quantity:</strong> {{ donation?.quantity }} people</div>
          <div class="mb-2"><strong class="text-muted">üìÖ Expiry:</strong> {{ donation?.expiry_time | date:'short' }}</div>
          <div class="mb-2"><strong class="text-muted">‚è∞ Created:</strong> {{ donation?.created_at | date:'medium' }}</div>
  
          <div class="mb-2">
            <strong class="text-muted">üì¶ Status:</strong>
            <span class="badge rounded-pill" [ngStyle]="{
              backgroundColor: donation?.status === 'OPEN' ? '#5B8C5A' : '#5B3711',
              color: 'white'
            }">
              {{ donation?.status }}
            </span>
          </div>
  
          <!-- View on Map -->
          <div class="mt-4">
            <a *ngIf="donation?.addressLink" class="btn btn-sm" href="{{ donation.addressLink }}" target="_blank"
              style="background-color: #F77F00; color: white;">
              View on Google Maps
            </a>
          </div>
        </div>
  
        <!-- Right Column -->
        <div class="col-lg-5">
          <!-- Donor Card -->
          <div class="border p-3 rounded-4 mb-4 bg-light shadow-sm">
            <h6 class="text-muted">üë§ Donor</h6>
            <div class="d-flex align-items-center">
              <div class="me-3">
                <div class="rounded-circle bg-secondary text-white d-flex justify-content-center align-items-center"
                  style="width: 50px; height: 50px; font-size: 18px;">
                  {{ donorInitials }}
                </div>
              </div>
              <div>
                <strong>{{ donation?.donorName }}</strong><br>
                <small>{{ donation?.donorNumber }}</small>
              </div>
            </div>
          </div>
  
          <!-- Map Embed -->
          <div *ngIf="donation?.addressLink" class="rounded-4 overflow-hidden shadow-sm" style="height: 300px;">
            <iframe
              width="100%" height="100%" frameborder="0" style="border:0;"
              [src]="donation.addressLink | safeUrl" allowfullscreen>
            </iframe>
          </div>
  
          <!-- Request Button -->
          <div class="mt-4">
            <button class="btn w-100" style="background-color: #5B8C5A; color: white;" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@getbootstrap">
              Request This Donation üç±
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  



  
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Request</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
              <label for="quantity" class="col-form-label">Quantity:</label>
              <input type="number" class="form-control" id="quantity">
            </div>
            <div class="mb-3">
              <label for="message" class="col-form-label">Message:</label>
              <textarea class="form-control" id="message"></textarea>
            </div>
           
           
           
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Request</button>
        </div>
      </div>
    </div>
  </div>






  <!-- Edit Modal -->
<div class="modal fade" id="editDonationModal" tabindex="-1" aria-labelledby="editDonationLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form (ngSubmit)="updateDonation()">
        <div class="modal-header">
          <h5 class="modal-title">Edit Donation</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>

        <div class="modal-body">
          <div class="mb-3">
            <label class="form-label">Title</label>
            <input type="text" class="form-control" [(ngModel)]="editableDonation.title" name="title">
          </div>
          <div class="mb-3">
            <label class="form-label">Description</label>
            <textarea class="form-control" [(ngModel)]="editableDonation.description" name="description"></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Quantity</label>
            <input type="number" class="form-control" [(ngModel)]="editableDonation.quantity" name="quantity">
          </div>
        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="submit" class="btn btn-primary">Save Changes</button>
        </div>
      </form>
    </div>
  </div>
</div>
